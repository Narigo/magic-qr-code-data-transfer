import{S as F,i as W,s as Y,e as g,k as Q,l as j,c as $,a as E,d as _,m as T,b as Z,g as m,o as w,p as ee,q as N,Q as te,v as ne,R as le,n as se,D as re,t as S,h as k,J as v,O as I,K as O,w as B,x as H,y as M,N as U,B as G,j as C,P as oe,T as ae}from"../chunks/vendor-a0cacfa4.js";import{H as V}from"../chunks/Headline-080cdd27.js";function x(u,e,n){const t=u.slice();return t[12]=e[n][0],t[13]=e[n][1],t}function ce(u){let e,n,t,r;return{c(){e=g("button"),n=S("Start scanning!")},l(o){e=$(o,"BUTTON",{});var l=E(e);n=k(l,"Start scanning!"),l.forEach(_)},m(o,l){m(o,e,l),v(e,n),t||(r=I(e,"click",u[5]),t=!0)},p:O,i:O,o:O,d(o){o&&_(e),t=!1,r()}}}function ie(u){let e,n,t,r,o,l;return e=new V({props:{$$slots:{default:[_e]},$$scope:{ctx:u}}}),{c(){B(e.$$.fragment),n=Q(),t=g("textarea")},l(s){H(e.$$.fragment,s),n=T(s),t=$(s,"TEXTAREA",{}),E(t).forEach(_)},m(s,a){M(e,s,a),m(s,n,a),m(s,t,a),U(t,u[2]),r=!0,o||(l=I(t,"input",u[7]),o=!0)},p(s,a){const h={};a&65536&&(h.$$scope={dirty:a,ctx:s}),e.$set(h),a&4&&U(t,s[2])},i(s){r||(N(e.$$.fragment,s),r=!0)},o(s){w(e.$$.fragment,s),r=!1},d(s){G(e,s),s&&_(n),s&&_(t),o=!1,l()}}}function fe(u){let e,n,t,r,o,l,s,a,h,i=Object.entries(u[3]),f=[];for(let c=0;c<i.length;c+=1)f[c]=A(x(u,i,c));return{c(){e=g("div"),n=S("Scanned QR data:"),t=Q(),r=g("ul");for(let c=0;c<f.length;c+=1)f[c].c();o=Q(),l=g("button"),s=S("Stop scanning!")},l(c){e=$(c,"DIV",{});var d=E(e);n=k(d,"Scanned QR data:"),d.forEach(_),t=T(c),r=$(c,"UL",{});var p=E(r);for(let R=0;R<f.length;R+=1)f[R].l(p);p.forEach(_),o=T(c),l=$(c,"BUTTON",{});var b=E(l);s=k(b,"Stop scanning!"),b.forEach(_)},m(c,d){m(c,e,d),v(e,n),m(c,t,d),m(c,r,d);for(let p=0;p<f.length;p+=1)f[p].m(r,null);m(c,o,d),m(c,l,d),v(l,s),a||(h=I(l,"click",u[6]),a=!0)},p(c,d){if(d&8){i=Object.entries(c[3]);let p;for(p=0;p<i.length;p+=1){const b=x(c,i,p);f[p]?f[p].p(b,d):(f[p]=A(b),f[p].c(),f[p].m(r,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=i.length}},i:O,o:O,d(c){c&&_(e),c&&_(t),c&&_(r),oe(f,c),c&&_(o),c&&_(l),a=!1,h()}}}function ue(u){let e,n,t,r,o;return e=new V({props:{$$slots:{default:[pe]},$$scope:{ctx:u}}}),{c(){B(e.$$.fragment),n=Q(),t=g("p"),r=S(u[1])},l(l){H(e.$$.fragment,l),n=T(l),t=$(l,"P",{});var s=E(t);r=k(s,u[1]),s.forEach(_)},m(l,s){M(e,l,s),m(l,n,s),m(l,t,s),v(t,r),o=!0},p(l,s){const a={};s&65536&&(a.$$scope={dirty:s,ctx:l}),e.$set(a),(!o||s&2)&&C(r,l[1])},i(l){o||(N(e.$$.fragment,l),o=!0)},o(l){w(e.$$.fragment,l),o=!1},d(l){G(e,l),l&&_(n),l&&_(t)}}}function _e(u){let e;return{c(){e=S("Successfully scanned all QR codes!")},l(n){e=k(n,"Successfully scanned all QR codes!")},m(n,t){m(n,e,t)},d(n){n&&_(e)}}}function A(u){let e,n=u[12]+"",t,r,o=u[13]+"",l;return{c(){e=g("li"),t=S(n),r=S(": "),l=S(o)},l(s){e=$(s,"LI",{});var a=E(e);t=k(a,n),r=k(a,": "),l=k(a,o),a.forEach(_)},m(s,a){m(s,e,a),v(e,t),v(e,r),v(e,l)},p(s,a){a&8&&n!==(n=s[12]+"")&&C(t,n),a&8&&o!==(o=s[13]+"")&&C(l,o)},d(s){s&&_(e)}}}function pe(u){let e;return{c(){e=S("Error scanning!")},l(n){e=k(n,"Error scanning!")},m(n,t){m(n,e,t)},d(n){n&&_(e)}}}function me(u){let e,n,t,r,o,l;const s=[ue,fe,ie,ce],a=[];function h(i,f){return i[0]==="ERROR"?0:i[0]==="SCANNING"?1:i[0]==="RESULT"?2:3}return t=h(u),r=a[t]=s[t](u),{c(){e=g("div"),n=Q(),r.c(),o=j(),this.h()},l(i){e=$(i,"DIV",{id:!0}),E(e).forEach(_),n=T(i),r.l(i),o=j(),this.h()},h(){Z(e,"id","reader")},m(i,f){m(i,e,f),m(i,n,f),a[t].m(i,f),m(i,o,f),l=!0},p(i,[f]){let c=t;t=h(i),t===c?a[t].p(i,f):(se(),w(a[c],1,1,()=>{a[c]=null}),ee(),r=a[t],r?r.p(i,f):(r=a[t]=s[t](i),r.c()),N(r,1),r.m(o.parentNode,o))},i(i){l||(N(r),l=!0)},o(i){w(r),l=!1},d(i){i&&_(e),i&&_(n),a[t].d(i),i&&_(o)}}}function de(u,e,n){let t,r="STOPPED",o=null,l="",s=re({});te(u,s,b=>n(3,t=b));let a,h=0,i=1;ne(()=>{a=new le("reader")});async function f(b){const R=async(y,he)=>{const L=y.substring(0,8),K=y.substring(9);ae(s,t[L]=K,t);const X=L.slice(-2);if(i=parseInt(X,10)+1,h=Object.keys(t).length,h===i){await d(),n(0,r="RESULT");const q=Object.entries(t);q.sort(([D],[P])=>D<P?-1:1),n(2,l=q.reduce((D,[P,z])=>D+z,"")),console.log({restoredData:l})}},J={fps:500,qrbox:{width:250,height:250}};try{await a.start({facingMode:"environment"},J,R),n(0,r="SCANNING")}catch(y){console.error(y),n(1,o=y.message)}}async function c(){await d(),n(0,r="STOPPED")}async function d(){try{await a.stop()}catch(b){console.error(b),n(1,o=b.message)}}function p(){l=this.value,n(2,l)}return[r,o,l,t,s,f,c,p]}class ge extends F{constructor(e){super();W(this,e,de,me,Y,{})}}export{ge as default};
